import clientPromise from "@/lib/mongodb";export default async function handler(req,res){const client=await clientPromise;const db=client.db("gameworlds");const isAdmin=req.headers["x-admin-email"]===process.env.NEXT_PUBLIC_ADMIN_EMAIL;if(req.method==="GET"){let s=await db.collection("settings").findOne({_id:"main"});if(!s){s={_id:"main",online:true,notice:"",offlineUntil:""};await db.collection("settings").insertOne(s);}return res.json(s);}if(req.method==="PUT"){if(!isAdmin) return res.status(401).json({message:"Not admin"});const body=req.body||{};await db.collection("settings").updateOne({_id:"main"},{ $set: body},{upsert:true});return res.json({ok:true});}return res.status(405).end();}
