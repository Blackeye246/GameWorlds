import NextAuth from "next-auth";import CredentialsProvider from "next-auth/providers/credentials";import clientPromise from "@/lib/mongodb";import bcrypt from "bcryptjs";export const authOptions={providers:[CredentialsProvider({name:"Credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"},},async authorize(credentials){const client=await clientPromise;const db=client.db("gameworlds");const user=await db.collection("users").findOne({email:credentials.email});if(!user) throw new Error("No user");const ok=await bcrypt.compare(credentials.password,user.password);if(!ok) throw new Error("Wrong password");return {id:user._id,name:user.name,email:user.email};}})],secret:process.env.NEXTAUTH_SECRET,pages:{signIn:"/login"},};export default NextAuth(authOptions);
