import clientPromise from "@/lib/mongodb";import bcrypt from "bcryptjs";export default async function handler(req,res){if(req.method!=="POST") return res.status(405).json({message:"Method not allowed"});try{const {name,email,password}=req.body;if(!name||!email||!password) return res.status(400).json({message:"Missing fields"});const client=await clientPromise;const db=client.db("gameworlds");const exists=await db.collection("users").findOne({email});if(exists) return res.status(400).json({message:"User exists"});const hashed=await bcrypt.hash(password,10);await db.collection("users").insertOne({name,email,password:hashed,createdAt:new Date()});res.status(201).json({message:"User created"});}catch(e){console.error(e);res.status(500).json({message:"Server error"});} }
